<!DOCTYPE html>
<html>
<head>
    <title>Debug Auth</title>
</head>
<body>
    <h1>Debug Authentication</h1>
    <div id="output"></div>
    
    <script>
        function log(message) {
            document.getElementById('output').innerHTML += '<p>' + message + '</p>';
        }
        
        // Check localStorage
        const token = localStorage.getItem('srivani_token');
        const refreshToken = localStorage.getItem('srivani_refresh_token');
        const user = localStorage.getItem('srivani_user');
        
        log('Token exists: ' + (token ? 'YES' : 'NO'));
        log('Refresh token exists: ' + (refreshToken ? 'YES' : 'NO'));
        log('User exists: ' + (user ? 'YES' : 'NO'));
        
        if (token) {
            log('Token length: ' + token.length);
            log('Token starts with: ' + token.substring(0, 20) + '...');
        }
        
        if (user) {
            try {
                const userData = JSON.parse(user);
                log('User ID: ' + userData.UserID);
                log('User Email: ' + userData.Email);
                log('User Role: ' + userData.Role);
            } catch (e) {
                log('Error parsing user data: ' + e.message);
            }
        }
        
        // Test API call
        if (token) {
            log('Testing API call...');
            fetch('http://localhost:3002/api/v1/auth/me', {
                headers: {
                    'Authorization': 'Bearer ' + token,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                log('API Response status: ' + response.status);
                return response.json();
            })
            .then(data => {
                log('API Response: ' + JSON.stringify(data, null, 2));
            })
            .catch(error => {
                log('API Error: ' + error.message);
            });
        }
    </script>
</body>
</html>
